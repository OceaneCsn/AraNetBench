---
title: "Using-AraNetBench"
output: 
  rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Using-AraNetBench}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(AraNetBench)
```

# Loading an example network

```{r}
data("abiotic_stress_Heat_genes_net")
knitr::kable(head(abiotic_stress_Heat_genes_net))
```


# Overview of validation data

```{r}
data("validated_edges")
knitr::kable(table(validated_edges$type))
```


# Validating a network


```{r}
results <- evaluate_network(abiotic_stress_Heat_genes_net)
results[c("tp", "fp", "tpr", "fpr")]
knitr::kable(head(results$edges, n = 20))
```



# Drawing the result of a network evaluation


```{r, fig.width=10, fig.height=10}
draw_evaluated_network(results)
```
To save the output in a files :

```{r, eval=FALSE}
draw_evaluated_network(results, export = TRUE)
```


# Test if the network contains biological signal or if the rate of validated edges does not differ from random

DAPSeq, CHIPSeq and TARGET information seems to be captured by the network inference : 

```{r, fig.width=8, fig.height=6}
test_validation_rate(abiotic_stress_Heat_genes_net, N = 100)
```
Whereas CHIPSeq signal alone in the network could have been achieved by randomly TFs to targets...

```{r, fig.width=8, fig.height=6}
test_validation_rate(abiotic_stress_Heat_genes_net, validation = c("CHIPSeq"), N = 100)
```




